#!/bin/bash

project=blank
license=MIT
repository=
name=

for arg in "$@"; do
	case "$arg" in

	--name=*)
        name=`echo $arg | sed 's/--name=//'`
    ;;

	--project=*)
        project=`echo $arg | sed 's/--project=//'`
    ;;

	--license=*)
        license=`echo $arg | sed 's/--license=//'`
    ;;

	--repository=*)
        repository=`echo $arg | sed 's/--repository=//'`
    ;;

	--help)
        echo 'usage: ./configure [options]'
        echo ''
        echo 'options:'
        echo '  --name=<name>: name of project'
        echo '  --project=<project>: target project (blank, html)'
		echo '  --license=<license>: license (AGPLv3, EUPLv1.2, GPLv3, MIT)'
		echo '  --repository=<repository>: repository (gitlab)'
        echo ''
        echo 'All invalid options are silently ignored!'
        exit 0
    ;;

	esac
done

if [ -z $name ]; then
	echo "You must specify name option"
	exit 0
fi

if [ -d ./generated/$name ]; then
	echo "Directory already exist"
	exit 0
fi

echo "Generating project $name..."

cp -rT ./templates/default/ ./generated/$name

if [ $project != "blank" ]; then
	cp -rT ./templates/configure/$project/ ./generated/$name
	cp -rT ./templates/projects/$project/ ./generated/$name
fi

echo "Add license $license..."
cp ./templates/LICENSE/$license ./generated/$name/LICENSE

if [ ! -z $repository ]; then
	cp -rT ./templates/docs/ ./generated/$name/.$repository

	if [ -d ./templates/CI/$project/$repository/ ]; then
		cp -rT ./templates/CI/$project/$repository/ ./generated/$name/.$repository
	fi
else
	cp -rT ./templates/docs/ ./generated/$name/docs/
fi

echo 'Configuration complete'
